{% extends "core/base_main.html" %}
{% load static %}
{% load experiment_extras %}

{% block title %}{{ suite.name }} - Suite Detail{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'experiments/css/suite_detail.css' %}">
<!-- AG Grid for results table -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.1.0/styles/ag-grid.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.1.0/styles/ag-theme-quartz.css">
{% endblock %}

{% block content %}
<div class="mx-auto py-8">
    
    <!-- Breadcrumb Navigation -->
    <nav class="flex mb-8" aria-label="Breadcrumb">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
            <li class="inline-flex items-center">
                <a href="{% url 'core:dashboard' %}" class="inline-flex items-center text-sm font-medium text-foreground-muted hover:text-brand-600">
                    <svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z"/>
                    </svg>
                    Dashboard
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <svg class="w-3 h-3 text-foreground-muted mx-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                    <a href="{% url 'experiments:suite_list' %}" class="ml-1 text-sm font-medium text-foreground-muted hover:text-brand-600 md:ml-2">Suites</a>
                </div>
            </li>
            <li aria-current="page">
                <div class="flex items-center">
                    <svg class="w-3 h-3 text-foreground-muted mx-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                    <span class="ml-1 text-sm font-medium text-foreground-default md:ml-2">{{ suite.name }}</span>
                </div>
            </li>
        </ol>
    </nav>

    <!-- Suite Header -->
    {% include 'experiments/partials/_suite_header.html' %}

    <!-- Performance Comparison Chart -->
    {% include 'experiments/partials/_suite_performance_chart.html' %}

    <!-- Optuna Optimization Charts -->
    {% include 'experiments/partials/_suite_optimization_charts.html' %}

    <!-- Results Table -->
    {% include 'experiments/partials/_suite_results_table.html' %}

</div>
{% endblock %}

{% block extra_js %}
<!-- Plotly for charts -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<!-- AG Grid for results table -->
<script src="https://cdn.jsdelivr.net/npm/ag-grid-community@31.1.0/dist/ag-grid-community.min.js"></script>
<script src="{% static 'experiments/js/suite_detail.js' %}"></script>

<script>
    // Pass suite data to JavaScript
    window.suiteData = {
        id: {{ suite.id }},
        name: "{{ suite.name|escapejs }}",
        experiments: {{ suite.experiments_json|safe }},
        {% if suite.optimization_history %}
        optimizationHistory: {{ suite.optimization_history|safe }},
        {% endif %}
        {% if suite.parameter_importances %}
        parameterImportances: {{ suite.parameter_importances|safe }}
        {% endif %}
    };
</script>
{% endblock %}