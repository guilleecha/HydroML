{% extends "core/base_main.html" %}
{% load static tabler_icons %}

{% block page_title %}Dashboard - HydroML{% endblock %}

{% block extra_css %}
<style>
    .stat-card {
        transition: all 0.2s ease-in-out;
    }
    .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    /* Ensure Grove card content doesn't have double padding */
    .stat-card .grove-card-content {
        padding: var(--space-6);
    }
    .pulse-animation {
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }
</style>
{% endblock %}

{% block page_heading %}{% endblock %}

{% block content %}
<div class="flex-1 bg-white dark:bg-gray-900">
    <!-- Header Section - Minimal Design -->
    <div class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900">
        <div class="max-w-7xl mx-auto px-8 py-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-semibold text-gray-900 dark:text-gray-100">
                        Dashboard
                    </h1>
                    <p class="mt-1 text-sm text-gray-600 dark:text-gray-400">
                        Resumen de tu actividad de machine learning
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-8 py-8">
        <!-- Statistics Cards -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-6">
                Resumen de tu Workspace
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- DataSources Card -->
                <div class="grove-card stat-card">
                    <div class="grove-card-content flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Fuentes de Datos</p>
                            <p class="text-3xl font-bold text-gray-900 dark:text-gray-100 mt-1">{{ total_datasources }}</p>
                            <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">Datasets disponibles</p>
                        </div>
                        <div class="bg-blue-100 dark:bg-blue-900/20 rounded-full p-3">
                            {% tabler_icon_outline 'database' 'w-6 h-6 text-blue-600 dark:text-blue-400' %}
                        </div>
                    </div>
                </div>

                <!-- Experiments Card -->
                <div class="grove-card stat-card">
                    <div class="grove-card-content flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium grove-text-secondary">Experimentos</p>
                            <p class="text-3xl font-bold grove-text-primary mt-1">{{ total_experiments }}</p>
                            <p class="text-xs grove-text-tertiary mt-1">Modelos entrenados</p>
                        </div>
                        <div class="bg-green-100 dark:bg-darcula-string/20 rounded-full p-3">
                            {% tabler_icon_outline 'flask' 'w-6 h-6 text-green-600 dark:text-darcula-string' %}
                        </div>
                    </div>
                </div>

                <!-- Experiment Suites Card -->
                <div class="grove-card stat-card">
                    <div class="grove-card-content flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium grove-text-secondary">Suites de Experimentos</p>
                            <p class="text-3xl font-bold grove-text-primary mt-1">{{ total_suites }}</p>
                            <p class="text-xs grove-text-tertiary mt-1">Estudios automatizados</p>
                        </div>
                        <div class="bg-purple-100 dark:bg-darcula-keyword/20 rounded-full p-3">
                            {% tabler_icon_outline 'layout-grid' 'w-6 h-6 text-purple-600 dark:text-darcula-keyword' %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- My Workspaces Section -->
        <div class="bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default">
            <div class="px-6 py-4 border-b border-border-default">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-foreground-default dark:text-darcula-foreground">
                        Workspaces
                    </h3>
                    <a href="{% url 'projects:project_list' %}" 
                       class="text-sm text-brand-600 dark:text-darcula-accent hover:text-brand-700 dark:hover:text-darcula-accent/80 font-medium">
                        Ver todos â†’
                    </a>
                </div>
            </div>
            
            <div class="p-6" x-init="viewMode = localStorage.getItem('dashboardWorkspaceViewMode') || 'grid'; $watch('viewMode', value => localStorage.setItem('dashboardWorkspaceViewMode', value))">
                {% if user_projects %}
                <!-- View Toggle -->
                <div class="mb-6 flex justify-end">
                    <div class="inline-flex items-center bg-background-secondary dark:bg-darcula-background-darker border border-border-default dark:border-darcula-border rounded-lg p-1">
                        <button @click="viewMode = 'grid'" 
                                :class="viewMode === 'grid' ? 'bg-background-primary dark:bg-darcula-background text-foreground-default dark:text-darcula-foreground shadow-sm' : 'text-foreground-muted dark:text-darcula-foreground-muted hover:text-foreground-default dark:hover:text-darcula-foreground'"
                                class="inline-flex items-center px-2 py-1 text-xs font-medium rounded-md transition-colors">
                            {% tabler_icon_outline 'grid-dots' 'w-3 h-3 mr-1' %}
                            Grid
                        </button>
                        <button @click="viewMode = 'list'" 
                                :class="viewMode === 'list' ? 'bg-background-primary dark:bg-darcula-background text-foreground-default dark:text-darcula-foreground shadow-sm' : 'text-foreground-muted dark:text-darcula-foreground-muted hover:text-foreground-default dark:hover:text-darcula-foreground'"
                                class="inline-flex items-center px-2 py-1 text-xs font-medium rounded-md transition-colors">
                            {% tabler_icon_outline 'list' 'w-3 h-3 mr-1' %}
                            List
                        </button>
                    </div>
                </div>

                <!-- Grid View -->
                <div x-show="viewMode === 'grid'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    {% for project in user_projects %}
                        <div class="bg-background-primary dark:bg-darcula-background-darker border border-border-default dark:border-darcula-border rounded-lg shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden">
                            <!-- Card Header -->
                            <div class="p-4 pb-3">
                                <div class="flex items-start justify-between mb-2">
                                    <h4 class="text-sm font-semibold text-foreground-default dark:text-darcula-foreground truncate pr-2">
                                        {{ project.name }}
                                    </h4>
                                    <span class="text-xs text-foreground-muted dark:text-onedark-accent1 bg-background-secondary px-2 py-1 rounded-full whitespace-nowrap">
                                        {{ project.created_at|date:"d M" }}
                                    </span>
                                </div>
                                
                                <!-- Project Description -->
                                <p class="text-xs text-foreground-secondary dark:text-onedark-accent1 line-clamp-2 mb-3">
                                    {{ project.description|default:"Sin descripciÃ³n disponible."|truncatewords:8 }}
                                </p>
                            </div>

                            <!-- Project Stats -->
                            <div class="px-4 pb-3">
                                <div class="flex items-center space-x-3 text-xs text-foreground-muted dark:text-onedark-accent1">
                                    <div class="flex items-center">
                                        {% tabler_icon_outline 'chart-bar' 'w-3 h-3 mr-1' %}
                                        <span>{{ project.datasources.count }}</span>
                                    </div>
                                    <div class="flex items-center">
                                        {% tabler_icon_outline 'flask' 'w-3 h-3 mr-1' %}
                                        <span>{{ project.experiments.count }}</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Card Footer -->
                            <div class="px-4 py-3 bg-background-secondary dark:bg-darcula-background border-t border-border-default dark:border-darcula-border">
                                <a href="{% url 'projects:project_detail' pk=project.pk %}" 
                                   class="inline-flex items-center justify-center w-full px-3 py-1.5 text-xs font-medium text-foreground-default bg-background-primary border border-border-default rounded-md hover:bg-background-tertiary hover:border-border-muted transition-colors">
                                    Ver Workspace
                                    {% tabler_icon_outline 'chevron-right' 'w-3 h-3 ml-1' %}
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <!-- List View -->
                <div x-show="viewMode === 'list'" class="overflow-hidden">
                    <table class="min-w-full">
                        <thead>
                            <tr class="border-b border-border-muted dark:border-darcula-border">
                                <th class="px-3 py-3 text-left text-xs font-medium text-foreground-muted dark:text-onedark-accent1 uppercase tracking-wider">
                                    Workspace
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-foreground-muted dark:text-onedark-accent1 uppercase tracking-wider">
                                    Datos
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-foreground-muted dark:text-onedark-accent1 uppercase tracking-wider">
                                    Experimentos
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-foreground-muted dark:text-onedark-accent1 uppercase tracking-wider">
                                    Creado
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-foreground-muted dark:text-onedark-accent1 uppercase tracking-wider">
                                    Acciones
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border-muted dark:divide-darcula-border">
                            {% for project in user_projects %}
                            <tr class="hover:bg-background-tertiary dark:hover:bg-darcula-background transition-colors">
                                <td class="px-3 py-4">
                                    <div class="flex items-center">
                                        <div>
                                            <div class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">
                                                {{ project.name }}
                                            </div>
                                            {% if project.description %}
                                            <div class="text-xs text-foreground-muted dark:text-onedark-accent1 truncate max-w-xs">
                                                {{ project.description|truncatewords:6 }}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </td>
                                <td class="px-3 py-4">
                                    <div class="text-sm text-foreground-default dark:text-darcula-foreground">
                                        {{ project.datasources.count }}
                                    </div>
                                </td>
                                <td class="px-3 py-4">
                                    <div class="text-sm text-foreground-default dark:text-darcula-foreground">
                                        {{ project.experiments.count }}
                                    </div>
                                </td>
                                <td class="px-3 py-4">
                                    <div class="text-sm text-foreground-default dark:text-darcula-foreground">
                                        {{ project.created_at|date:"d M Y" }}
                                    </div>
                                </td>
                                <td class="px-3 py-4">
                                    <a href="{% url 'projects:project_detail' pk=project.pk %}"
                                       class="inline-flex items-center px-2 py-1 border border-border-default rounded text-xs font-medium text-foreground-default dark:text-darcula-foreground bg-background-primary dark:bg-darcula-background hover:bg-background-tertiary dark:hover:bg-darcula-background-lighter transition-colors">
                                        {% tabler_icon_outline 'eye' 'w-3 h-3 mr-1' %}
                                        Ver
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="text-center py-12">
                    {% tabler_icon_outline 'layout-grid' 'w-12 h-12 text-foreground-muted dark:text-darcula-foreground-muted mx-auto mb-4' %}
                    <h3 class="text-lg font-medium text-foreground-default dark:text-darcula-foreground mb-2">
                        No hay workspaces aÃºn
                    </h3>
                    <p class="text-foreground-muted dark:text-darcula-foreground-muted mb-6">
                        Comienza creando tu primer workspace para organizar tus datos y experimentos de machine learning.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-3 justify-center">
                        <button @click="openNewProjectPanel()"
                           class="inline-flex items-center px-4 py-2 bg-brand-600 hover:bg-brand-700 text-white font-medium rounded-lg transition-colors">
                            {% tabler_icon_outline 'plus' 'w-4 h-4 mr-2' %}
                            Crear Primer Workspace
                        </button>
                        <button type="button"
                                @click="openUploadPanel()"
                                class="inline-flex items-center px-4 py-2 border border-border-default text-foreground-default dark:text-darcula-foreground hover:bg-background-tertiary dark:hover:bg-darcula-background-lighter font-medium rounded-lg transition-colors">
                            {% tabler_icon_outline 'upload' 'w-4 h-4 mr-2' %}
                            Subir Datos
                        </button>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Quick Actions Section -->
        {% if user_projects_count > 0 %}
        <div class="mt-8">
            <h3 class="text-lg font-semibold text-foreground-default dark:text-darcula-foreground mb-4">
                Acciones RÃ¡pidas
            </h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <button @click="openNewProjectPanel()"
                   class="flex items-center p-4 bg-white dark:bg-darcula-background-lighter rounded-lg border border-border-default hover:bg-background-tertiary dark:hover:bg-darcula-background transition-colors group w-full text-left">
                    <div class="bg-brand-100 dark:bg-darcula-accent/20 rounded-lg p-2 mr-3">
                        {% tabler_icon_outline 'plus' 'w-5 h-5 text-brand-600 dark:text-darcula-accent' %}
                    </div>
                    <div>
                        <div class="text-sm font-medium text-foreground-default dark:text-darcula-foreground group-hover:text-brand-600 dark:group-hover:text-darcula-accent">
                            Nuevo Workspace
                        </div>
                        <div class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">
                            Crear workspace
                        </div>
                    </div>
                </button>

                <button type="button"
                        @click="openUploadPanel()"
                        class="flex items-center p-4 bg-white dark:bg-darcula-background-lighter rounded-lg border border-border-default hover:bg-background-tertiary dark:hover:bg-darcula-background transition-colors group">
                    <div class="bg-blue-100 dark:bg-darcula-accent/20 rounded-lg p-2 mr-3">
                        {% tabler_icon_outline 'upload' 'w-5 h-5 text-blue-600 dark:text-darcula-accent' %}
                    </div>
                    <div>
                        <div class="text-sm font-medium text-foreground-default dark:text-darcula-foreground group-hover:text-blue-600 dark:group-hover:text-darcula-accent">
                            Subir Datos
                        </div>
                        <div class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">
                            Cargar dataset
                        </div>
                    </div>
                </button>

                <a href="{% url 'experiments:public_experiment_list' %}"
                   class="flex items-center p-4 bg-white dark:bg-darcula-background-lighter rounded-lg border border-border-default hover:bg-background-tertiary dark:hover:bg-darcula-background transition-colors group">
                    <div class="bg-green-100 dark:bg-darcula-string/20 rounded-lg p-2 mr-3">
                        {% tabler_icon_outline 'flask' 'w-5 h-5 text-green-600 dark:text-darcula-string' %}
                    </div>
                    <div>
                        <div class="text-sm font-medium text-foreground-default dark:text-darcula-foreground group-hover:text-green-600 dark:group-hover:text-darcula-string">
                            Explorar Experimentos
                        </div>
                        <div class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">
                            Ver pÃºblicos
                        </div>
                    </div>
                </a>

                <a href="{% url 'core:help' %}"
                   class="flex items-center p-4 bg-white dark:bg-darcula-background-lighter rounded-lg border border-border-default hover:bg-background-tertiary dark:hover:bg-darcula-background transition-colors group">
                    <div class="bg-purple-100 dark:bg-darcula-keyword/20 rounded-lg p-2 mr-3">
                        {% tabler_icon_outline 'help-circle' 'w-5 h-5 text-purple-600 dark:text-darcula-keyword' %}
                    </div>
                    <div>
                        <div class="text-sm font-medium text-foreground-default dark:text-darcula-foreground group-hover:text-purple-600 dark:group-hover:text-darcula-keyword">
                            Obtener Ayuda
                        </div>
                        <div class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">
                            DocumentaciÃ³n
                        </div>
                    </div>
                </a>
            </div>
        </div>
        {% endif %}

        <!-- Key Technologies Section -->
        <div class="mt-12">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold text-foreground-default dark:text-darcula-foreground">
                    LibrerÃ­as de Referencia
                </h3>
                <p class="text-sm text-foreground-muted dark:text-darcula-foreground-muted">
                    Stack tecnolÃ³gico de HydroML
                </p>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                <!-- Python -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://python.org" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/python.svg' %}" alt="Python" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Python</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">Backend</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://docs.python.org" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/python/cpython" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- Django -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://djangoproject.com" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/django.svg' %}" alt="Django" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Django</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">Framework</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://docs.djangoproject.com" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded hover:bg-green-100 dark:hover:bg-green-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/django/django" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- Pandas -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://pandas.pydata.org" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/pandas.svg' %}" alt="Pandas" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Pandas</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">Data Analysis</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://pandas.pydata.org/docs/" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-100 dark:hover:bg-purple-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/pandas-dev/pandas" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- Scikit-learn -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://scikit-learn.org" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/scikit-learn.svg' %}" alt="Scikit-learn" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Scikit-learn</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">ML Library</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://scikit-learn.org/stable/" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-orange-50 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 rounded hover:bg-orange-100 dark:hover:bg-orange-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/scikit-learn/scikit-learn" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- Celery -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://docs.celeryproject.org" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/celery.svg' %}" alt="Celery" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Celery</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">Task Queue</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://docs.celeryproject.org" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded hover:bg-green-100 dark:hover:bg-green-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/celery/celery" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- Docker -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://docker.com" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/docker.svg' %}" alt="Docker" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Docker</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">Containers</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://docs.docker.com" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/docker/docker-ce" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- Plotly -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://plotly.com" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/plotly.svg' %}" alt="Plotly" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Plotly</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">Visualization</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://plotly.com/python/" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/plotly/plotly.py" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            {% tabler_icon_filled 'brand-github' 'w-3 h-3 mr-1' %}
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- MLflow -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://mlflow.org" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/mlflow.svg' %}" alt="MLflow" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">MLflow</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">ML Ops</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://mlflow.org/docs/latest/index.html" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-cyan-50 dark:bg-cyan-900/30 text-cyan-700 dark:text-cyan-300 rounded hover:bg-cyan-100 dark:hover:bg-cyan-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/mlflow/mlflow" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>

                <!-- Tailwind CSS -->
                <div class="flex flex-col items-center p-6 bg-white dark:bg-darcula-background-lighter rounded-xl border border-border-default hover:shadow-md transition-all group">
                    <a href="https://tailwindcss.com" target="_blank" class="flex flex-col items-center mb-3">
                        <div class="w-16 h-16 mb-4 flex items-center justify-center rounded-lg group-hover:scale-110 transition-transform">
                            <img src="{% static 'core/img/logos/tailwindcss.svg' %}" alt="Tailwind CSS" class="w-12 h-12">
                        </div>
                        <span class="text-sm font-medium text-foreground-default dark:text-darcula-foreground">Tailwind</span>
                        <span class="text-xs text-foreground-muted dark:text-darcula-foreground-muted">CSS Framework</span>
                    </a>
                    <div class="flex space-x-2 mt-auto">
                        <a href="https://tailwindcss.com/docs" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-teal-50 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300 rounded hover:bg-teal-100 dark:hover:bg-teal-900/50 transition-colors">
                            {% tabler_icon_outline 'book' 'w-3 h-3 mr-1' %}
                            Docs
                        </a>
                        <a href="https://github.com/tailwindlabs/tailwindcss" target="_blank" 
                           class="flex items-center px-2 py-1 text-xs bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.30.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Featured Public Experiments Section -->
        <div class="mt-12">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold text-foreground-default dark:text-darcula-foreground">
                    ðŸ§ª Experimentos PÃºblicos Destacados
                </h3>
                <a href="{% url 'experiments:public_experiment_list' %}" 
                   class="text-sm text-brand-600 dark:text-darcula-accent hover:text-brand-700 dark:hover:text-darcula-accent/80 font-medium">
                    Ver todos â†’
                </a>
            </div>
            
            {% if featured_public_experiments %}
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {% for experiment in featured_public_experiments %}
                        <div class="bg-white dark:bg-darcula-background-darker border border-border-default dark:border-darcula-border rounded-xl shadow-card p-6 hover:shadow-lg transition-shadow">
                            <!-- Experiment Header -->
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex-1 min-w-0">
                                    <h4 class="text-lg font-semibold text-foreground-default dark:text-darcula-foreground truncate">{{ experiment.name }}</h4>
                                    <p class="text-sm text-foreground-muted dark:text-darcula-foreground-muted mt-1">
                                        Por <span class="font-medium text-brand-600 dark:text-darcula-accent">@{{ experiment.project.owner.username }}</span>
                                    </p>
                                </div>
                                <span class="ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-secondary text-success-primary border border-success-primary">
                                    PÃºblico
                                </span>
                            </div>

                            <!-- Experiment Description -->
                            {% if experiment.description %}
                            <div class="mb-4">
                                <p class="text-sm text-foreground-secondary dark:text-darcula-foreground-muted line-clamp-3">{{ experiment.description|truncatewords:15 }}</p>
                            </div>
                            {% endif %}

                            <!-- Experiment Info -->
                            <div class="mb-4 space-y-2">
                                <!-- Model Type -->
                                <div class="flex items-center text-sm text-foreground-secondary dark:text-darcula-foreground-muted">
                                    {% tabler_icon_outline 'device-laptop' 'w-4 h-4 mr-2' %}
                                    {{ experiment.model_name }}
                                </div>
                                
                                <!-- Performance Metric -->
                                {% if experiment.results %}
                                    <div class="flex items-center text-sm text-foreground-secondary dark:text-darcula-foreground-muted">
                                        {% tabler_icon_outline 'chart-bar' 'w-4 h-4 mr-2' %}
                                        {% if experiment.results.r2_score %}
                                            RÂ² Score: {{ experiment.results.r2_score|floatformat:3 }}
                                        {% elif experiment.results.accuracy %}
                                            Accuracy: {{ experiment.results.accuracy|floatformat:3 }}
                                        {% elif experiment.results.f1_score %}
                                            F1 Score: {{ experiment.results.f1_score|floatformat:3 }}
                                        {% elif experiment.results.mse %}
                                            MSE: {{ experiment.results.mse|floatformat:3 }}
                                        {% else %}
                                            MÃ©tricas disponibles
                                        {% endif %}
                                    </div>
                                {% endif %}
                                
                                <!-- Publication Date -->
                                <div class="flex items-center text-sm text-foreground-muted dark:text-darcula-foreground-muted">
                                    {% tabler_icon_outline 'clock' 'w-4 h-4 mr-2' %}
                                    {% if experiment.published_at %}
                                        {{ experiment.published_at|date:"d M, Y" }}
                                    {% else %}
                                        {{ experiment.created_at|date:"d M, Y" }}
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Status Badge -->
                            <div class="mb-4">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                                    {% if experiment.status == 'FINISHED' %}bg-success-secondary text-success-primary border border-success-primary
                                    {% elif experiment.status == 'RUNNING' %}bg-warning-secondary text-warning-primary border border-warning-primary
                                    {% elif experiment.status == 'FAILED' %}bg-danger-secondary text-danger-primary border border-danger-primary
                                    {% else %}bg-blue-50 text-blue-700 border border-blue-200{% endif %}">
                                    {{ experiment.get_status_display }}
                                </span>
                            </div>

                            <!-- Action Button -->
                            <div class="flex justify-center">
                                <a href="{% url 'experiments:ml_experiment_detail' pk=experiment.pk %}" 
                                   class="inline-flex items-center px-3 py-2 text-sm font-semibold text-foreground-default bg-background-tertiary border border-border-default rounded-lg hover:bg-background-secondary transition-colors">
                                    {% tabler_icon_outline 'eye' 'w-4 h-4 mr-2' %}
                                    Ver Detalles
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <!-- Empty State -->
                <div class="text-center py-12 bg-white dark:bg-darcula-background-lighter rounded-xl border-2 border-dashed border-border-muted dark:border-darcula-border">
                    {% tabler_icon_outline 'device-laptop' 'mx-auto h-12 w-12 text-foreground-muted dark:text-darcula-foreground-muted' %}
                    <h4 class="mt-2 text-sm font-medium text-foreground-default dark:text-darcula-foreground">No hay experimentos pÃºblicos</h4>
                    <p class="mt-1 text-sm text-foreground-muted dark:text-darcula-foreground-muted">
                        AÃºn no hay experimentos compartidos por la comunidad.
                    </p>
                    <div class="mt-6">
                        <a href="{% url 'experiments:public_experiment_list' %}" 
                           class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-gray-800 dark:bg-gray-700 border border-gray-800 dark:border-gray-700 rounded-lg hover:bg-gray-900 dark:hover:bg-gray-600 transition-colors">
                            {% tabler_icon_outline 'info-circle' 'w-4 h-4 mr-2' %}
                            Explorar GalerÃ­a
                        </a>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
